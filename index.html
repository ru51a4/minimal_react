<body>

<div class="main">
    <counter />
</div>
</body>

<script>
    var Render;

    class component_counter {
        state = {
            counter: 0,
            counter2: 0
        };

        body() {
            return `
            <div>counter - ${this.state.counter} counter - ${this.state.counter2}
            <div>
            <div>
            ssasdasdasdasdssasdasdasdasdssasdasdasdasdssasddasdasdssasdasdasdasdssasdasdasdasdssas
            dasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasd
            asdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdasdasdasdssasdasdasdasdssasda
            sdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasd
            asdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasddasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasds
            sasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasd
            asdasddasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasds
            sasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasddasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasds
            sasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasddasdasdssasdasdasdasdssasdasdasdasdssasdasd
            asdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasddasdasdssasdas
            dasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssa
            sdasdasdasddasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasd
            asdssasdasdasdasdssasdasdasdasddasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasd
            asdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasddasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdas
            dasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasdssasdasdasdasd
            </div>
            </div>
            <btn></btn>
            </div>
        `
        };

        plus() {
            this.state.counter++;
            Render.renderDom();
        }
    }

    class component_btn {
        body() {
            return `
                <button onclick="components.btn.plus()">plus</button>
                <text></text>
                `
        };

        plus() {
            components.counter.plus();
        }
    }

    class component_text {
        body() {
           return `<text2></text2>`
        };
    }

    class component_text2 {
        body() {
            return `<div>texdt</div>`
        };
    }

    var components = {};

    class render {
        currentDom;

        constructor(props) {
            components = [
                    {
                        name: 'counter',
                        component: component_counter
                    },
                    {
                        name: 'btn',
                        component: component_btn
                    },
                    {
                        name: 'text',
                        component: component_text
                    },
                    {
                        name: 'text2',
                        component: component_text2
                    }
                ];
            this.currentDom = document.querySelector('.main').innerHTML.trim().split("\n");
        }

        renderDom() {
            var currentDom = '';
            this.currentDom.forEach((tag) => {
                //deep
                function deep(tag) {
                    if(this.utils.isComponent(tag)) {
                        deep(tag)
                    } else {
                      console.log(tag);
                      let component = components.find((item) => item.name === tag).component();
                      currentDom += `${component.body()} \n`;
                    }
                }
                deep.bind(this, tag)();
                //
            });
            console.log(currentDom);
        }

        utils = {
          isComponent(tag){
              return components.includes(tag);
          }
        };
    }

    Render = new render();

    function main() {
        Render.renderDom();
    }

    main();
</script>
